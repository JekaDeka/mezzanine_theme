{% extends "base.html" %}
{% load i18n mezzanine_tags accounts_tags pages_tags theme_tags staticfiles %}

{% block meta_title %}{{ shop.shopname }}{% endblock %}
{% block meta_description %}{% metablock %}
{{ shop.bio|safe }}
{% endmetablock %}{% endblock %}

{% block breadcrumbs %}
{% endblock %}

{% block slider %}
<div class="container fullwidth-element" style="background: url({{ MEDIA_URL }}{% thumbnail shop.background 1300 150 %}) center; height: 150px; margin-bottom: 35px;">
	<img src="{{ MEDIA_URL }}{% thumbnail shop.image 150 150 %}" alt="{{shop.shopname}}" class="shop-image pull-right margin-top-10 margin-right-5" />
</div>

{% endblock %}

{% block main %}
{% if shop.on_vacation %}
<div class="sixteen columns">
    <div class="notification error text-center">
    <p>Магазин на каникулах</p>
</div>
</div>
<div class="clearfix"></div>
{% endif %}
<div class="eleven columns">
    <br>
    <h2 class="headline" style="margin-top:-37px; font-size: 35px!important;">{{ shop.shopname }}</h2>
    <span class="line"></span>
    <div class="clearfix"></div>
    <div>{{ shop.bio|safe }}</div>
    {% if shop.rules %}
        <h3 class="headline margin-top-25">Правила магазина</h3>
        <span class="line"></span>
        <div class="clearfix"></div>
        <div>{{ shop.rules|safe }}</div>
    {% endif %}
    
</div>
<div class="five columns">
    {% get_fields shop starts_with="express" as express_fields %}
    {% if express_fields %}
    <h3 class="headline">Доставка</h3><span class="line"></span><div class="clearfix"></div>
    <div class="list-2">
        <ul>
            {% for fields in express_fields|grouped %}
            <li>
                {% for field in fields %} 
                    {% if field.value == True %}
                        <span> {{ field.label }}</span> 
                    {% else %}
                        <span style="white-space: nowrap">{{ field.value|rub_currency }} </span> 
                    {% endif %} 
                {% endfor %}
            </li>
            {% endfor %}
        </ul>
        <div>{{ shop.express_other }}</div>
    </div>
    <div class="clearfix"></div>
    {% endif %}
    {% get_fields shop starts_with="payment" as payment_fields %}
    {% if payment_fields %}
    <h3 class="headline">Оплата</h3>
    <span class="line"></span>
    <div class="clearfix"></div>
    <div class="list-2">
        <ul>
            {% for field in payment_fields %}
            {% if field.value == True %}
                <li>{{ field.label }}</li>
            {% endif %}
            {% endfor %}
        </ul>
    <p>{{ shop.payment_other }}</p>
    </div>
    {% endif %}
    <div class="clearfix"></div>
</div>
<div class="five columns" style="float: right">
    <h3 class="headline">Контакты</h3>
    <span class="line" style="margin-bottom:0px;"></span>
    <div class="clearfix"></div>
    <span> {{ shop.user.get_full_name }}, </span>
    <span class="phone"> {{ shop.phone }} </span>
    <p>{{ shop.country }} {{ shop.region }}</p>
    <div class="clearfix"></div>
    <div style="margin: 5px 0 0 0;"></div>
    <a class="popup-with-zoom-anim button color" href="#small-dialog">Задать вопрос</a>
        <div id="small-dialog" class="zoom-anim-dialog mfp-hide">
            <h2 class="margin-bottom-10">Задайте вопрос магазину</h2>
            <form action="" method="POST">
            {% csrf_token %}
            {{ form.as_p }}
            <button class="button color" type="submit"><i class="fa fa-send black"></i>Отправить вопрос</button>
            </form>
        </div>
</div>
<div class="clearfix"></div>
<div class="sixteen columns margin-top-25">
	{# {% include "accounts/includes/shop_widget.html" %} #}
</div>
{% endblock %}


{% block extra_js %} 
{{ block.super }}
<script type="text/javascript">
$(document).ready(function() {
	$(".phone").text(function(i, text) {
		text = text.replace(/(\d{1})(\d{3})(\d{3})(\d{4})/, "$1-$2-$3-$4");
		return text;
	});
});
</script>
<script>
$(function() {
    $('.a_reply').click(function() {
        // $('.comment-reply-form').hide();
        $(this).parent().parent().parent().next().toggle('500');
        // $(this).find('.comment-reply-form').toggle();
    });
});
</script>
{% endblock %}