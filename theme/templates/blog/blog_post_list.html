{% extends "base.html" %}
{% load i18n mezzanine_tags blog_tags pages_tags keyword_tags disqus_tags theme_tags %}

{% block meta_title %}{% if page %}{{ page.meta_title }}{% else %}{% trans "Blog" %}{% endif %}{% endblock %}

{% block meta_keywords %}{% metablock %}
{% keywords_for page as keywords %}
{% for keyword in keywords %}
	{% if not forloop.first %}, {% endif %}
	{{ keyword }}
{% endfor %}
{% endmetablock %}{% endblock %}

{% block meta_description %}{% metablock %}
{{ page.description }}
{% endmetablock %}{% endblock %}


{% block main %}
<div id="masonry-wrapper">
{% for blog_post in blog_posts.object_list %}
	<div class="one-third column masonry-item">
		<article class="from-the-blog">
			{% if settings.BLOG_USE_FEATURED_IMAGE and blog_post.featured_image %}
			{% block blog_post_list_post_featured_image %}
			<figure class="from-the-blog-image">
				<a href="{{ blog_post.get_absolute_url }}">
					<img class="img-thumbnail pull-left" src="{{ MEDIA_URL }}{% thumbnail blog_post.featured_image 400 300 %}" alt="" />
				</a>
				<div class="hover-icon"></div>
			</figure>
			{% endblock %}
			{% endif %}
			<section class="from-the-blog-content">
				{% block blog_post_list_post_title %}
				{# {% editable blog_post.title %} #}
					<a href="{{ blog_post.get_absolute_url }}"><h5>{{ blog_post.title }}</h5></a>
				{# {% endeditable %} #}
				{% endblock %}
				{% block blog_post_list_post_metainfo %}
					{# {% editable blog_post.publish_date %} #}
					{% with blog_post.user as author %}
					<i>{% trans "Posted by" %}: <a href="{% url "blog_post_list_author" author %}">{{ author.get_full_name|default:author.username }}</a>,  
					{% blocktrans with sometime=blog_post.publish_date|date %}{{ sometime }}{% endblocktrans %}
					</i>
					{% endwith %}
					{# {% endeditable %} #}
				{% endblock %}
				{% block blog_post_list_post_content %}
				{% if blog_post.preview_content %}
					{# {% editable blog_post.preview_content %} #}
					{{ blog_post.preview_content|safe  }}
					{# {% endeditable %} #}
				{% else %}
					{# {% editable blog_post.content %} #}
					{{ blog_post.description_from_content|safe }}
					{# {% endeditable %} #}
				{% endif %}
				{% endblock %}
				<a href="{{ blog_post.get_absolute_url }}" class="button gray">{% trans "read more" %}</a>
			</section>
		</article>
	</div>
{% endfor %}
</div>

{% pagination_for blog_posts %}
{% endblock %}


