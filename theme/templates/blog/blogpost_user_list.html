{% extends "base.html" %} {% load i18n mezzanine_tags pages_tags staticfiles %}
{% block meta_title %}
Список записей
{% endblock %}
{% block breadcrumbs_title %}
<h2>Блог</h2>
{% endblock breadcrumbs_title %}
{% block breadcrumb_element %}
<li><a href="{% url 'profile-settings' %}">Личный кабинет</a></li>
<li>Список моих записей</li>
{% endblock %}
{% block main %}
<div class="sixteen columns margin-bottom-25">
    <h2>Осталось доступных записей: {{ remain }}</h2>
    {% if remain > 0 %}
        <a class="button dark" href="{% url 'blogpost-add' %}">Добавить запись в блог</a>
    {% endif %}
    <a class="button dark" href="{% url 'blogpost-list' %}">Получить больше</a>
</div>
<hr>
<div class="clearfix"></div>
{% if blogpost_list %}
<div id="masonry-wrapper">
    {% for blogpost in blogpost_list %}
        <div class="object-list columns masonry-item">
            <article class="from-the-blog">
                {% if settings.BLOG_USE_FEATURED_IMAGE %}
                    {% if blogpost.featured_image %}
                    <figure class="from-the-blog-image">
                        <a href="{{ blogpost.get_absolute_url }}">
                            <img class="img-thumbnail pull-left" src="{{ MEDIA_URL }}{% thumbnail blogpost.featured_image 300 200 %}" alt="{{ blogpost.title }}" />
                        </a>
                        <div class="hover-icon"></div>
                    </figure>
                    {% else %}
                    <div class="post-quote">
                        <a href="{{ blogpost.get_absolute_url }}">
                        <blockquote>
                            <i class="fa fa-camera-retro"></i>
                        </blockquote>
                        </a>
                    </div>
                    {% endif %}
                {% endif %}
                <section class="from-the-blog-content">
                    <a href="{{ blogpost.get_absolute_url }}"><h5>{{ blogpost.title|title }}</h5></a>
                    {% if blogpost.preview_content %}
                        {{ blogpost.preview_content|safe|truncatewords_html:55 }}
                    {% else %}
                        {{ blogpost.description_from_content|safe }}
                    {% endif %}
                <div class="clearfix"></div>
                <a href="{% url 'blogpost-update' blogpost.pk %}" class="button gray margin-top-5">Редактировать</a>
                <a href="{% url 'blogpost-delete' blogpost.pk %}" class="button gray margin-top-5">Удалить</a>
                </section>

            </article>
        </div>
    {% endfor %}
</div>
{% else %}
<section id="not-found">
    <p>Записи пока отсутствуют</p>
</section>
{% endif %}
    {% if is_paginated %}
        <div class="pagination-container masonry">
            <nav class="pagination">
                <ul>
                    {% for i in page_obj.paginator.page_range %}
                      {% if page_obj.number == i %}
                        <li><a href="#" class="current-page">{{ i }}</a></li>
                      {% else %}
                        <li><a href="?page={{ i }}">{{ i }}</a></li>
                      {% endif %}
                    {% endfor %}
                </ul>
            </nav>
            <nav class="pagination-next-prev full-width">
                <ul>
                    {% if page_obj.has_previous %}
                        <li><a href="?page={{ page_obj.previous_page_number }}" class="prev"></a></li>
                    {% endif %}
                    {% if page_obj.has_next %}
                        <li><a href="?page={{ page_obj.next_page_number }}" class="next"></a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    {% endif %}
{% endblock main %}
